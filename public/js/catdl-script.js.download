var encodedurl=window.btoa(window.location.href);function fun_dlcat(id){$("#div_showprocess").show();console.log(efdomain);$.post(efdomain+"ajax_files/ajax_thankyou.php",{flagdlcat:"true",catid:id,encodedurl:encodedurl},function(response){$("#div_showprocess").hide();$("#div_showmsg").html(response);});}$(".thin-close").click(function(){$("#div_showmsg").html('');});function getXMLHTTP(){var xmlhttp=false;try{xmlhttp=new XMLHttpRequest();}catch(e){try{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){try{xmlhttp=new ActiveXObject("Msxml2.XMLHTTP");}catch(e1){xmlhttp=false;}}}return xmlhttp;}jQuery("body").on("focusin","#phone,#fax",function(){jQuery('#phone,#fax').mask("999-999-9999");jQuery("#phone,#fax").on("blur",function(){var last=jQuery(this).val().substr(jQuery(this).val().indexOf("-")+1);if(last.length==5){var move=jQuery(this).val().substr(jQuery(this).val().indexOf("-")+1,1);var lastfour=last.substr(1,4);var first=jQuery(this).val().substr(0,9);jQuery(this).val(first+move+'-'+lastfour);}});});function funchklogin(id,cattype){if(typeof(cattype)==='undefined'){cattype='cat';}$.post(efdomain+"ajax_files/loginform.php",{flag:'getloginform',catid:id,cattype:cattype},function(response){$("#div_loginformcontent").html(response);});}jQuery("body").one("click",".btnfrmlogin",function(){var valid=$('#loginfrm').parsley('validate');$('#loginfrm').submit(function(e){var catid=$("#div_loginformcontent").find("#hidcatid").val();var cattype=$("#div_loginformcontent").find("#hidcattype").val();var email=$("#div_loginformcontent").find("#user_email").val();var password=window.btoa($("#div_loginformcontent").find("#user_password").val());var hidden_user='';$("#ajax_loader_join").show();$.post("ajax.php",{action:"user_login",email:email,password:password,hidden_user:hidden_user},function(response){$("#ajax_loader_join").hide();if(response=="0"){$("#div_login_err").addClass('alert alert-danger').html("<strong>Error!</strong> Wrong email or password");}else{$(".clsloginfrm").trigger('click');setusersess();$("a#al_dlcat").attr("href","#div_dlcat");a_dlcatname=$("a#al_dlcat").attr("class");$("a#al_dlcat").attr("onclick","fun_dlcat("+a_dlcatname+");");if($("#al_dlmk").length>0){$("a#al_dlmk").attr("href","#div_dlcat");a_dlmkname=$("a#al_dlmk").attr("class");$("a#al_dlmk").attr("onclick","fun_dlcat("+a_dlmkname+");");}if(cattype=='mk'&&$("#al_dlmk").length>0){$("a#al_dlmk").trigger('click');}else{$("a#al_dlcat").trigger('click');}$("#div_dlcat").css('overflow','auto');}});return false;});});$(".clsloginfrm").click(function(){var flg=true;if($("#frmsignupstep2").length>0){var ans=confirm('Are You sure, You don\'t want to proceed?');if(ans){catid=$("#div_loginformcontent").find("#hidcatid").val();$.post(efdomain+"ajax_files/ajax_thankyou.php",{flagdlcat:"true",flagsignupdropstep2:"true",catid:catid,encodedurl:encodedurl},function(response){});}else if(!ans){flg=false;}}if(flg){$("#div_loginformcontent").html('');}if(!flg){return false;}});jQuery("body").one("click",".clsfrmsignup",function(){var valid=$('#frmsignup').parsley('validate');$('#frmsignup').submit(function(e){error=0
$("#frmsignup input[id=new_user_email]").blur();if($("#frmsignup input[id=hid_email_error]").val()!='false'){error++;$("#frmsignup input[id=new_user_email]").focus();}else{$("#frmsignup div[id=div_em_error]").html('');}if(error>0){return false;}catid=$("#div_loginformcontent").find("#hidcatid").val();cattype=$("#div_loginformcontent").find("#hidcattype").val();fnm=window.btoa($("#frmsignup input[id=first_name]").val());lnm=window.btoa($("#frmsignup input[id=last_name]").val());em=window.btoa($("#frmsignup input[id=new_user_email]").val());phn=window.btoa($("#frmsignup input[id=phone]").val());jobtitle=window.btoa($("#frmsignup input[id=job_title]").val());coname=window.btoa($("#frmsignup input[id=company_name]").val());var strURL_liaison=efdomain+"ajax_files/loginform.php?fnm="+fnm+"&lnm="+lnm+"&em="+em+"&jobtitle="+jobtitle+"&coname="+coname+"&phone="+phn+"&catid="+catid+"&flag=signupstep2";var req=getXMLHTTP();if(req){req.onreadystatechange=function(){if(req.readyState==4){if(req.status==200){jQuery(".divsignup").html(req.responseText);setusersess();$("a#al_dlcat").attr("href","#div_dlcat");a_dlcatname=$("a#al_dlcat").attr("class");$("a#al_dlcat").attr("onclick","fun_dlcat("+a_dlcatname+");");if($("#al_dlmk").length>0){$("a#al_dlmk").attr("href","#div_dlcat");a_dlmkname=$("a#al_dlmk").attr("class");$("a#al_dlmk").attr("onclick","fun_dlcat("+a_dlmkname+");");}}else{console.log("There was a problem while using XMLHTTP:\n"+req.statusText);}}}
req.open("GET",strURL_liaison,true);req.send("action=myAjaxFunction");}return false;});});jQuery("body").one("click",".clsfrmsignupstep2",function(){var valid=$('#frmsignupstep2').parsley('validate');$('#frmsignupstep2').submit(function(e){country=$("#frmsignupstep2 select[id=country]").val();postal_code=$("#frmsignupstep2 input[id=postal_code]").val();var error=0;if(postal_code!=""){if((country=="2")&&(postal_code.search(/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ]( )?\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i)==-1)||(country=="1")&&(postal_code.search(/^\d{5}(-\d{4})?$/)==-1)){$("#frmsignupstep2 input[id=postalcode]").focus();error++;}}if(error>0){alert("The zip/postal code you entered is not valid.");$("#frmsignupstep2 input[id=postal_code]").focus();return false;}e.preventDefault();catid=$("#frmsignupstep2 input[id=hidcatid]").val();cattype=$("#div_loginformcontent").find("#hidcattype").val();uid=window.btoa($("#frmsignupstep2 input[id=hiduser]").val());fax=window.btoa($("#frmsignupstep2 input[id=fax]").val());address1=window.btoa($("#frmsignupstep2 input[id=address1]").val());address2=window.btoa($("#frmsignupstep2 input[id=address2]").val());city=window.btoa($("#frmsignupstep2 input[id=city]").val());province=window.btoa($("#frmsignupstep2 select[id=province]").val());postal_code=window.btoa(postal_code);var strURL_liaison=efdomain+"ajax_files/loginform.php?uid="+uid+"&fax="+fax+"&address1="+address1+"&address2="+address2+"&city="+city+"&province="+province+"&postal_code="+postal_code+"&catid="+catid+"&flag=signupstep3";var req=getXMLHTTP();if(req){req.onreadystatechange=function(){if(req.readyState==4){if(req.status==200){$("#div_loginformcontent").html('');$(".clsloginfrm").trigger('click');setusersess();$("a#al_dlcat").attr("href","#div_dlcat");a_dlcatname=$("a#al_dlcat").attr("class");$("a#al_dlcat").attr("onclick","fun_dlcat("+a_dlcatname+");");if($("#al_dlmk").length>0){$("a#al_dlmk").attr("href","#div_dlcat");a_dlmkname=$("a#al_dlmk").attr("class");$("a#al_dlmk").attr("onclick","fun_dlcat("+a_dlmkname+");");}if(cattype=='mk'&&$("#al_dlmk").length>0){$("a#al_dlmk").trigger('click');}else{$("a#al_dlcat").trigger('click');}$("#div_dlcat").css('overflow','auto');}else{console.log("There was a problem while using XMLHTTP:\n"+req.statusText);}}}
req.open("GET",strURL_liaison,true);req.send("action=myAjaxFunction");}return false;});});jQuery("body").on("change","#country",function(){var country=jQuery(this).val();$.post(efdomain+'ajax_files/get_province.php',{"country":country},function(response){if(response!=''){$("#frmsignupstep2 select[id=province]").html(response);}else{console.log('Error!');}});});jQuery("body").on("blur","#new_user_email",function(){em=$("#frmsignup input[id=new_user_email]").val();if(em!=''){$.post(efdomain+'ajax_files/loginform.php',{"flag_chk_email":"true","em":em},function(response){if(response!=''){$("#frmsignup div[id=div_em_error]").html(response);$("#frmsignup input[id=hid_email_error]").val('true');}else{$("#frmsignup input[id=hid_email_error]").val('false');$("#frmsignup div[id=div_em_error]").html('');}});}});function setusersess(){var html1=$("#spanuserloginhtml").html();ans=html1.replace("<!---","");ans=ans.replace("=-->","");$("#myaccount_id").html(ans);$.post("ajax.php",{action:"welcome_message"},function(response){$("#wlcm_text").html(response);});}